<?xml-stylesheet type="text/xsl" href="F:\Development\XML\JobLoader\job_parameter_values.xsl"?>
<ETL VERSION="1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="F:\Development\XML\ketl.xsd">

	<JOB ID="PRODUCT_DIM"  NAME="PRODUCT_DIM"  PROJECT="SIMPLESTART" TYPE="KETL">
		<ACTION>
		    <!--  read comma seperated file -->
			<STEP NAME="Reader" TIMING="TRUE" CLASS="com.kni.etl.ketl.reader.XMLReader" XPATHEVALUATE="FALSE" XPATH="PRODUCT" PARAMETER_LIST="Products">
				<OUT NAME="MODIFICATION_DATE" DATATYPE="DATE" FORMATSTRING="dd/MM/yyyy" XPATHEVALUATE="FALSE" XPATH="@MODIFIED_ON"/>
				<OUT NAME="PRODUCT_NATURAL_KEY" DATATYPE="STRING" XPATHEVALUATE="FALSE" XPATH="@CODE"/>
				<OUT NAME="NAME" DATATYPE="STRING" XPATHEVALUATE="FALSE" XPATH="DESCRIPTION"/>
				<OUT NAME="CATEGORY" DATATYPE="STRING" XPATHEVALUATE="FALSE" XPATH="CATEGORY"/>
				<OUT NAME="LINE" DATATYPE="STRING" XPATHEVALUATE="FALSE" XPATH="LINE"/>
            </STEP>
                   
			<STEP DEBUG="TRUE" PERSISTENCE="LOAD" xMANAGEINDEXES="TRUE" JOININDEX="SYS_C004233" NAME="Product" CLASS="com.kni.etl.ketl.writer.JDBCSCDWriter" EXPIRATIONDATECOLUMN="EXPIRATION_TIMESTAMP" SURROGATEKEY="PRODUCT_SURROGATE_KEY" TABLE="PRODUCT_DIMENSION" PARAMETER_LIST="TargetDB">
                <IN SK="1">Reader.PRODUCT_NATURAL_KEY</IN> 
                <IN>Reader.LINE</IN> 
                <IN EFFECTIVEDATE="TRUE" NAME="EFFECTIVE_TIMESTAMP">Reader.MODIFICATION_DATE</IN> 
                <IN>Reader.NAME</IN> 
                <IN>Reader.CATEGORY</IN> 
		   	</STEP>
			
		</ACTION>
	</JOB>

</ETL>
